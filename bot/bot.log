nohup: ignoring input
ğŸ”„ Tentative de connexion MongoDB #1...
âœ… MongoDB connectÃ© avec succÃ¨s
âœ… MongoDB connectÃ©: ac-rxln3be-shard-00-00.oghzx2v.mongodb.net
ğŸ“Š Loaded 6 existing users from database
â„¹ï¸ Configuration existante trouvÃ©e
ğŸŒ Initialisation des traductions...
ğŸŒ Initialisation des traductions...
âœ… Traductions par dÃ©faut initialisÃ©es
âœ… Traductions initialisÃ©es
ğŸ”„ Migration automatique des rÃ©seaux sociaux...
ğŸ”— Connexion Ã  MongoDB rÃ©ussie
ğŸ“‹ 3 plugs trouvÃ©s
ğŸ‰ Migration terminÃ©e: 0 plugs migrÃ©s
âœ… Migration terminÃ©e avec succÃ¨s
ğŸ”„ Initialisation du cache...
ğŸ”„ RafraÃ®chissement du cache...
âœ… Cache mis Ã  jour - 3 plugs, config: OK
âœ… Cache initialisÃ© et programmÃ© pour se rafraÃ®chir toutes les 30s
âœ… Bot en mode polling (dÃ©veloppement)
âœ… Serveur dÃ©marrÃ© sur le port 3004
ğŸ“± Bot Telegram connectÃ©
ğŸŒ API disponible sur http://localhost:3004
ğŸ“Š Cache: 3 plugs, config: OK
ğŸ”„ RafraÃ®chissement du cache...
âœ… Cache mis Ã  jour - 3 plugs, config: OK
ğŸš€ Commande /start reÃ§ue de: 7670522278
âŒ Erreur lors de l'enregistrement utilisateur: StrictModeError: Path "userId" is not in schema, strict mode is `true`, and upsert is `true`.
    at cast (/workspace/bot/node_modules/mongoose/lib/cast.js:305:17)
    at Query.cast (/workspace/bot/node_modules/mongoose/lib/query.js:5055:12)
    at Query._castConditions (/workspace/bot/node_modules/mongoose/lib/query.js:2351:10)
    at model.Query._findOneAndUpdate (/workspace/bot/node_modules/mongoose/lib/query.js:3454:8)
    at model.Query.exec (/workspace/bot/node_modules/mongoose/lib/query.js:4604:80)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async handleStart (/workspace/bot/src/handlers/startHandler.js:65:7)
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17) {
  isImmutableError: false,
  path: 'userId'
}
ğŸ”„ Config rechargÃ©e depuis la DB
ğŸŒ Menu principal affichÃ© en langue: de
ğŸ“¸ Envoi message avec image: https://i.imgur.com/leViC3R.jpeg
âœ… Message avec image envoyÃ©
ğŸ”„ Callback reÃ§u: start_application
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5710
ğŸŒ Formulaire d'inscription en langue: de
âš ï¸ editMessageText Ã©chouÃ©: 400: Bad Request: there is no text in the message to edit
ğŸš€ Commande /start reÃ§ue de: 7670522278
âŒ Erreur lors de l'enregistrement utilisateur: StrictModeError: Path "userId" is not in schema, strict mode is `true`, and upsert is `true`.
    at cast (/workspace/bot/node_modules/mongoose/lib/cast.js:305:17)
    at Query.cast (/workspace/bot/node_modules/mongoose/lib/query.js:5055:12)
    at Query._castConditions (/workspace/bot/node_modules/mongoose/lib/query.js:2351:10)
    at model.Query._findOneAndUpdate (/workspace/bot/node_modules/mongoose/lib/query.js:3454:8)
    at model.Query.exec (/workspace/bot/node_modules/mongoose/lib/query.js:4604:80)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async handleStart (/workspace/bot/src/handlers/startHandler.js:65:7)
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17) {
  isImmutableError: false,
  path: 'userId'
}
ğŸŒ Menu principal affichÃ© en langue: de
ğŸ“¸ Envoi message avec image: https://i.imgur.com/leViC3R.jpeg
âœ… Message avec image envoyÃ©
ğŸ”„ Callback reÃ§u: select_language
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸŒ Affichage sÃ©lecteur langue, langue actuelle: de
ğŸŒ CrÃ©ation clavier langue, langue actuelle: de
ğŸ”¤ Langue fr: ğŸ‡«ğŸ‡· FranÃ§ais (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue en: ğŸ‡¬ğŸ‡§ English (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue it: ğŸ‡®ğŸ‡¹ Italiano (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue es: ğŸ‡ªğŸ‡¸ EspaÃ±ol (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue de: âœ… ğŸ‡©ğŸ‡ª Deutsch (sÃ©lectionnÃ©e: true)
âœ… Clavier langue crÃ©Ã© avec 5 langues
âœ… Message avec image modifiÃ© pour sÃ©lection langue
ğŸ”„ Callback reÃ§u: lang_es
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸŒ Changement de langue vers: es
âœ… Langue sauvegardÃ©e: es
ğŸ§¹ Tous les caches vidÃ©s
âŒ Erreur changement langue: ReferenceError: createMainKeyboard is not defined
    at /workspace/bot/index.js:373:22
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
ğŸ”„ Callback reÃ§u: lang_es
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸŒ Changement de langue vers: es
âœ… Langue sauvegardÃ©e: es
ğŸ§¹ Tous les caches vidÃ©s
âŒ Erreur changement langue: ReferenceError: createMainKeyboard is not defined
    at /workspace/bot/index.js:373:22
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
ğŸ”„ Callback reÃ§u: lang_it
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸŒ Changement de langue vers: it
âœ… Langue sauvegardÃ©e: it
ğŸ§¹ Tous les caches vidÃ©s
âŒ Erreur changement langue: ReferenceError: createMainKeyboard is not defined
    at /workspace/bot/index.js:373:22
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
    at async execute (/workspace/bot/node_modules/telegraf/lib/composer.js:518:17)
    at async /workspace/bot/node_modules/telegraf/lib/composer.js:519:21
ğŸ”„ Callback reÃ§u: back_main
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ”™ Retour au menu principal demandÃ©
ğŸ“‹ Configuration rÃ©cupÃ©rÃ©e pour le retour
ğŸŒ Langue actuelle pour le retour: it
ğŸ“ Message d'accueil prÃ©parÃ© pour le retour avec traduction
ğŸ–¼ï¸ Images: plug=false, welcome=true, isPlugDetails=false, using=true
ğŸ“¸ URL image utilisÃ©e: https://i.imgur.com/leViC3R.jpeg...
âœ… Message Ã©ditÃ© avec image (welcome)
âœ… Retour au menu principal terminÃ©
ğŸ”„ Callback reÃ§u: select_language
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸŒ Affichage sÃ©lecteur langue, langue actuelle: it
ğŸŒ CrÃ©ation clavier langue, langue actuelle: it
ğŸ”¤ Langue fr: ğŸ‡«ğŸ‡· FranÃ§ais (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue en: ğŸ‡¬ğŸ‡§ English (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue it: âœ… ğŸ‡®ğŸ‡¹ Italiano (sÃ©lectionnÃ©e: true)
ğŸ”¤ Langue es: ğŸ‡ªğŸ‡¸ EspaÃ±ol (sÃ©lectionnÃ©e: false)
ğŸ”¤ Langue de: ğŸ‡©ğŸ‡ª Deutsch (sÃ©lectionnÃ©e: false)
âœ… Clavier langue crÃ©Ã© avec 5 langues
âœ… Message avec image modifiÃ© pour sÃ©lection langue
ğŸ”„ Callback reÃ§u: back_main
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ”™ Retour au menu principal demandÃ©
ğŸ“‹ Configuration rÃ©cupÃ©rÃ©e pour le retour
ğŸŒ Langue actuelle pour le retour: it
ğŸ“ Message d'accueil prÃ©parÃ© pour le retour avec traduction
ğŸ–¼ï¸ Images: plug=false, welcome=true, isPlugDetails=false, using=true
ğŸ“¸ URL image utilisÃ©e: https://i.imgur.com/leViC3R.jpeg...
âœ… Message Ã©ditÃ© avec image (welcome)
âœ… Retour au menu principal terminÃ©
ğŸ”„ Callback reÃ§u: top_plugs
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ“ Context updated to: top_plugs
ğŸ” Top Plugs: 3 plugs trouvÃ©s
ğŸ“Š Services disponibles: Consegna(3), Spedizione postale(3), Incontro(3)
ğŸ–¼ï¸ Images: plug=false, welcome=true, isPlugDetails=false, using=true
ğŸ“¸ URL image utilisÃ©e: https://i.imgur.com/leViC3R.jpeg...
âœ… Message Ã©ditÃ© avec image (welcome)
ğŸ”„ Callback reÃ§u: all_plugs
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ”„ Callback reÃ§u: filter_service
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ” Affichage du menu des services
ğŸ“Š Services disponibles: Livraison(3), Postal(3), Meetup(3)
ğŸ–¼ï¸ Images: plug=false, welcome=true, isPlugDetails=false, using=true
ğŸ“¸ URL image utilisÃ©e: https://i.imgur.com/leViC3R.jpeg...
âœ… Message Ã©ditÃ© avec image (welcome)
ğŸ”„ Callback reÃ§u: service_delivery
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ” Recherche de plugs avec service: delivery
ğŸ“‹ RequÃªte MongoDB: { isActive: true, "services.delivery.enabled": true }
âœ… Plugs trouvÃ©s pour delivery: 3
ğŸ–¼ï¸ Images: plug=false, welcome=true, isPlugDetails=false, using=true
ğŸ“¸ URL image utilisÃ©e: https://i.imgur.com/leViC3R.jpeg...
âœ… Message Ã©ditÃ© avec image (welcome)
ğŸ”„ Callback reÃ§u: top_plugs
ğŸ‘¤ User ID: 7670522278, Chat ID: 7670522278
ğŸ“ Message ID: 5713
ğŸ“ Context updated to: top_plugs
ğŸ” Top Plugs: 3 plugs trouvÃ©s
ğŸ“Š Services disponibles: Consegna(3), Spedizione postale(3), Incontro(3)
ğŸ–¼ï¸ Images: plug=false, welcome=true, isPlugDetails=false, using=true
ğŸ“¸ URL image utilisÃ©e: https://i.imgur.com/leViC3R.jpeg...
âœ… Message Ã©ditÃ© avec image (welcome)
ğŸ”„ RafraÃ®chissement du cache...
âœ… Cache mis Ã  jour - 3 plugs, config: OK
